# Project11: impl sm2 with RFC6979
## 一、实验原理
SM2椭圆曲线公钥密码算法属于非对称加密算法，是我国自主知识产权的商用密码算法。
作为ECC算法的一种，基于椭圆曲线离散对数问题。
由于其计算复杂度为指数级，因此在同等安全要求下，较之其他公钥密码而言，椭圆曲线密码所需密钥长度小。SM2的密钥长度为256bit。<br>
### 加密
1、用随机数发生器产生随机数k (1<k<n-1)<br>
2、计算椭圆曲线点C1=[k]G=(x1,y1)，并将其转换为比特串（A的私钥生成公钥）<br>
3、计算椭圆曲线点S=[h]Pb，若S是无穷远点，则报错并退出 h为n的余因子<br>
4、计算椭圆曲线点[k]Pb=(x2,y2)，并将其转换为比特串（A的私钥乘B的公钥）<br>
5、计算t=KDF(x2||y2,klen)，若t为全0比特串，则返回①; KDF为密钥派生函数<br>
6、计算C2=M⊕t<br>
7、计算C3=Hash(x2||M||y2)<br>
8、输出密文C=C1||C3||C2<br>
### 解密
1、从C中取出比特串C1，将其转换为椭圆曲线上的点，验证C1是否满足椭圆曲线方程<br>
2、计算椭圆曲线点S=[h]Pb，若S是无穷远点，则报错并退出<br>
3、计算[db]C1=(x2,y2)，并将其转换为比特串 db B的公钥<br>
4、计算t=KDF(x2||y2,klen)，若t为全0比特串，则返回（一） KDF为密钥派生函数<br>
5、从C中取出比特串C2,计算M=C2⊕t<br>
6、计算u=Hash(x2||M||y2)，从C中取出比特串C3，若u不等于C3，则报错并退出<br>
7、输出明文M<br>
## 二、代码说明
共包含以下两个python文件：<br>
pre_SM2.py：适用于SM2的前置算法。包含SM2的系统参数以及一些运算（椭圆曲线上点加、逆元、点减、点乘等）<br>
mySM2.py：用于实现SM2，需要用到pre_SM2.py。运行时先生成一对公私钥，然后利用公钥对消息进行加密，利用私钥对消息进行解密。
## 三、运行结果
运行mySM2.py
![SM2](https://github.com/hsgroup30num1/homework-group-30/assets/129477640/813b66ce-d302-4179-a808-08d134456844)
## 四、参考文献
[1]https://blog.csdn.net/qq_44245503/article/details/126116193

